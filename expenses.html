<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8">
  <title>מה מצבינו - רשימת הוצאות</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="app-shell">

  <header class="app-header">
    <div class="app-header-top">
      <div class="app-header-title-block">
        <h1 class="app-title">מה מצבינו</h1>
        <p class="app-subtitle">מעקב הוצאות משפחתי</p>
      </div>
      <a href="{{ url_for('add_expense') }}" class="primary-button">
        + הוצאה
      </a>
    </div>

    <div class="app-tabs">
      <a href="{{ url_for('index', month=selected_month) }}" class="tab-link tab-active">
        הוצאות
      </a>
      <a href="{{ url_for('reports', month=selected_month) }}" class="tab-link">
        דוחות
      </a>
    </div>

    <div class="summary-bar">
      <div class="summary-item">
        <span class="summary-label">סה״כ הוצאות</span>
        <span class="summary-value">{{ "{:,.2f}".format(total_amount) }} ₪</span>
      </div>
      <div class="summary-item">
        <span class="summary-label">מספר פעולות</span>
        <span class="summary-value">{{ total_rows }}</span>
      </div>
    </div>

    {% if months %}
      <form method="get" action="{{ url_for('index') }}" class="filter-bar">
        <label for="month" class="filter-label">חודש</label>
        <select name="month" id="month" class="filter-select" onchange="this.form.submit()">
          {% for m in months %}
            <option value="{{ m.key }}" {% if m.key == selected_month %}selected{% endif %}>
              {{ m.label }}
            </option>
          {% endfor %}
        </select>
      </form>
    {% endif %}
  </header>

  <main class="content">

    {% if expenses %}
      <div class="expense-list">
        {% for e in expenses %}
          <article class="expense-card">
            <div class="expense-main">
              <div class="expense-header-row">
                <span class="expense-date">{{ e.date }}</span>
                <span class="expense-amount">
                  {{ "{:,.2f}".format(e.amount) }} ₪
                </span>
              </div>

              <p class="expense-desc">
                {{ e.description }}
              </p>

              <div class="expense-meta-row">
                <span class="expense-pill">{{ e.category }}</span>
                <span class="expense-pill pill-muted">{{ e.payment_method }}</span>
              </div>
            </div>

            <div class="expense-actions">
              <a href="{{ url_for('edit_expense', expense_id=e.id) }}" class="action-btn edit-btn">
                ✏ ערוך
              </a>
              <a href="{{ url_for('delete_expense', expense_id=e.id) }}"
                 class="action-btn delete-btn"
                 onclick="return confirm('למחוק הוצאה זו?');">
                🗑 מחק
              </a>
            </div>
          </article>
        {% endfor %}
      </div>
    {% else %}
      <p class="empty-state">
        אין הוצאות לחודש שנבחר. אפשר להוסיף הוצאה חדשה עם הכפתור למעלה.
      </p>
    {% endif %}

  </main>

</div>
</body>
</html>
