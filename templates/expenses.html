<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8">
  <title>מה מצבינו - רשימת הוצאות</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="app-shell">

  <header class="app-header">
    <div class="app-header-top">
      <h1 class="app-title">מה מצבינו</h1>
      <nav class="header-actions">
        <a href="{{ url_for('reports', month=selected_month) }}"
           class="header-link header-icon-link"
           aria-label="דוחות">
           📊
        </a>
  <a href="{{ url_for('add_expense') }}" class="primary-button">+ הוצאה</a>
</nav>
    </div>
    <div class="summary-bar">
      <span>סה״כ שורות: {{ total_rows }}</span>
      <span>סה״כ הוצאות: {{ "%.2f" | format(total_amount) }} ₪</span>
    </div>

    {% if months %}
      <form method="get" class="filter-bar">
        <label for="month-select">חודש:</label>
        <select id="month-select" name="month" onchange="this.form.submit()">
          {% for m in months %}
            <option value="{{ m.key }}" {% if m.key == selected_month %}selected{% endif %}>
              {{ m.label }}
            </option>
          {% endfor %}
        </select>
      </form>
    {% endif %}
  </header>

  <main class="content">
    {% if expenses %}
      <div class="expense-list">
        {% for exp in expenses %}
          <article class="expense-card">
            <div class="expense-main">
              <div class="expense-header">
                <span class="expense-date">{{ exp["date"] }}</span>
                <span class="expense-amount">{{ "%.2f" | format(exp["amount"]) }} ₪</span>
              </div>
              <p class="expense-description">
                {{ exp["description"] }}
              </p>
              <div class="expense-meta">
                <span>{{ exp["category"] }}</span>
              </div>
            </div>

            <div class="expense-actions">
              <a href="{{ url_for('edit_expense', expense_id=exp['id']) }}"
                 class="chip-btn chip-edit">
                ערוך
              </a>
              <a href="{{ url_for('delete_expense', expense_id=exp['id']) }}"
                 class="chip-btn chip-delete"
                 onclick="return confirm('למחוק את ההוצאה הזו?');">
                מחק
              </a>
            </div>
          </article>
        {% endfor %}
      </div>
    {% else %}
      <p class="empty-state">אין הוצאות לחודש שנבחר. נסה לבחור חודש אחר או להוסיף הוצאה.</p>
    {% endif %}
  </main>

</div>
</body>
</html>
